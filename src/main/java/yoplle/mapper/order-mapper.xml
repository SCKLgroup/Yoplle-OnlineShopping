<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="yoplle">
	<select id="getOrderDeSequence" resultType="int">
		SELECT ORDERINFO_SEQ.NEXTVAL FROM DUAL
	</select>
	
	<select id="getOrderInfoSequence" resultType="int">
		SELECT ORDERINFO_SEQ.NEXTVAL FROM DUAL
	</select>
	
	<insert id="insertOrderInfo" parameterType="yoplle.vo.OrderInfoVO">
		INSERT INTO 
		ORDERINFO(ORDER_NO, USER_NO, ORDER_REC_NAME, ORDER_REC_TEL, ORDER_DATE, ORDER_DV_STS, ORDER_DV_ADDR, ORDER_DV_ZIPCODE)
		VALUES(#{order_no}, #{user_no}, #{order_rec_name}, #{order_rec_tel}, sysdate, #{order_dv_sts}, #{order_dv_addr}, #{order_dv_zipcode})
	</insert>
	
	<insert id="insertOrderDe" parameterType="yoplle.vo.OrderDeVO">
		INSERT INTO ORDER_DE(OR_DE_NO, ORDER_NO, ITEM_NO, OR_DE_PRICE, OR_DE_QUAN, OR_DE_BACK)
		VALUES(#{or_de_no}, #{order_no}, #{item_no}, #{or_de_price}, #{or_de_quan}, #{or_de_back})
	</insert>
	
	<select id="getItemPrice" parameterType="int" resultType="int">
		SELECT ITEM_PRICE FROM ITEM WHERE ITEM_NO=#{itemNo}
	</select>
	
	<select id="getRpeSequence" resultType="java.lang.Integer">
		SELECT RECIPE_SEQ.NEXTVAL
		FROM DUAL
	</select>
	
	<insert id="insertOrderCartDe" parameterType="yoplle.vo.OrderDeCartVO">
		INSERT INTO ORDER_DE(OR_DE_NO, ORDER_NO, ITEM_NO, OR_DE_PRICE, OR_DE_QUAN, OR_DE_BACK)
		VALUES(#{or_de_no}, #{order_no}, #{item_no}, #{or_de_price}, #{or_de_quan}, #{or_de_back})
	</insert>
	
	<update id="stockDownAction" parameterType="HashMap">
		UPDATE ITEM SET ITEM_STOCK=#{ea} WHERE item_no=#{no} 
	</update>
	
	<select id="stockCheck" parameterType="int" resultType="int">
		select item_stock from item where item_no=#{no}
	</select>
	

</mapper>
